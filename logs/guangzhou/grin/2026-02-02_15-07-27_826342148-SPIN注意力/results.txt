# Attention Dropout = 0.2

(grin) root@autodl-container-aa6147b8a1-28f58848:~/autodl-tmp/USAGNN-DA# python ./scripts/run_imputation.py --config config/grin/guangzhou.yaml --use-semantic True
/root/miniconda3/envs/grin/lib/python3.8/site-packages/pytorch_lightning/core/decorators.py:65: LightningDeprecationWarning: The `@auto_move_data` decorator is deprecated in v1.3 and will be removed in v1.5. Please use `trainer.predict` instead for inference. The decorator was applied to `forward`
  rank_zero_deprecation(
Namespace(adj_threshold=0.1, aggregate_by=['mean'], alpha=10.0, batch_size=32, config='config/grin/guangzhou.yaml', consistency_loss=False, d_emb=8, d_ff=64, d_hidden=64, d_train_freq=5, d_u=0, dataset_name='guangzhou', decoder_order=1, delay=0, detrend=False, epochs=100, ff_dropout=0.0, g_train_freq=1, global_att=False, grad_clip_algorithm='norm', grad_clip_val=5.0, hint_rate=0.7, horizon=24, impute_only_holes=True, in_sample=False, kernel_size=2, l2_reg=0.0, layer_norm=False, loss_fn='l1_loss', lr=0.001, merge='mlp', model_name='grin', n_layers=1, patience=20, pred_loss_weight=1.0, samples_per_epoch=None, scale=True, scaled_target=True, scaling_axis='global', scaling_type='std', seed=-1, stride=1, test_len=0.2, use_lr_schedule=True, use_semantic=True, val_len=0.1, warm_up=0, whiten_prob=0.05, window=24, workers=0)
Global seed set to 826342148
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
2026-02-02 15:07:32.219781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0

  | Name          | Type             | Params
---------------------------------------------------
0 | loss_fn       | MaskedMetric     | 0     
1 | train_metrics | MetricCollection | 0     
2 | val_metrics   | MetricCollection | 0     
3 | test_metrics  | MetricCollection | 0     
4 | model         | GRINet           | 228 K 
---------------------------------------------------
228 K     Trainable params
0         Non-trainable params
228 K     Total params
0.915     Total estimated model params size (MB)
Global seed set to 826342148                                                                                      
Epoch 22: 100%|█| 17/17 [00:08<00:00,  2.24it/s, loss=0.68, v_num=0, val_mae=4.100, val_mape=0.501, val_mre=0.337,
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                         
Testing: 100%|██████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  5.25it/s]--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'test_loss': 2.6021568775177,
 'test_mae': 2.602109432220459,
 'test_mape': 0.20331309735774994,
 'test_mre': 0.14131596684455872,
 'test_mse': 11.624401092529297}
--------------------------------------------------------------------------------
Testing: 100%|██████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  5.14it/s]
- AGGREGATE BY MEAN
 mae: 2.5707
 mse: 11.2407
 mre: 0.1386
 mape: 0.1929